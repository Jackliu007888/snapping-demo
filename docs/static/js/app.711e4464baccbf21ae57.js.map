{"version":3,"sources":["webpack:///./src/common.js","webpack:///src/components/rectangle.vue","webpack:///./src/components/rectangle.vue?2605","webpack:///src/components/svg-canvas.vue","webpack:///./src/components/rectangle.vue","webpack:///./src/components/svg-canvas.vue?9e02","webpack:///./src/components/svg-canvas.vue","webpack:///./src/app.js","webpack:///./src/main.js"],"names":["common","SVGElement","e","point","createSVGPoint","x","clientX","y","clientY","position","matrixTransform","getScreenCTM","inverse","Utils","fn","delay","immediate","arguments","length","undefined","debounce","curr","Date","last_call","last_exec","timer","diff","context","args","exec","apply","this","clearTimeout","setTimeout","pointsToSize","points","width","height","getPoints","rect","correctX","correctY","rectangle","name","props","data","watch","val","assign_default","methods","dragElement","_this","draged","viewportRef","getViewportRef","mouseDownPosition","originPosition","mousemoveHandler","currentPosition","$emit","id","window","addEventListener","mouseupHandler","ev","removeEventListener","components_rectangle","render","_h","$createElement","_self","_c","attrs","stroke","stroke-width","fill","on","mousedown","staticRenderFns","RectList","svg_canvas","components","__webpack_require__","normalizeComponent","ID_TEMPLATE","shapeList","map","i","extends_default","svg_canvas_getPoints","measuringLine","dragingShape","$refs","svg","handleDragingShape","shapeId","dragingShapePoints","measuringLineX","measuringLineY","closestX","distance","Infinity","pointIndex","correct","closestY","forEach","shape","pointXDiff","pointYDiff","Math","abs","handleDragEnd","components_svg_canvas","_vm","ref","viewBox","_v","_l","key","update:points","$event","$set","draging","x1","y1","x2","y2","src_components_svg_canvas","svg_canvas_normalizeComponent","app","h","vue_esm","config","productionTip","el"],"mappings":"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","file":"static/js/app.711e4464baccbf21ae57.js","sourcesContent":["/**\n * 获取鼠标位置在svg元素中的坐标\n * @param   {SVGElement}  SVGElement  SVG元素\n * @param   {Event}       e           Event\n * @return  {Object}                  鼠标指针在SVG中的坐标（xy结构）\n */\nconst getPositionInSvg = (SVGElement, e) => {\n  const point = SVGElement.createSVGPoint()\n\n  point.x = e.clientX\n  point.y = e.clientY\n\n  const position = point.matrixTransform(SVGElement.getScreenCTM().inverse())\n\n  return {\n    x: position.x,\n    y: position.y,\n  }\n}\n\n/**\n * 角度转弧度(通常用于js的计算正弦余弦的方法)\n * @param   {Number}  degree  角度\n * @return  {Number}          弧度\n */\nconst degreeToRadian = degree => 2 * Math.PI / 360 * degree\n\n/**\n * 计算根据圆心旋转后的点的坐标\n * @param   {Object}  point   旋转前的点坐标\n * @param   {Object}  center  旋转中心\n * @param   {Int}     rotate  旋转的角度\n * @return  {Object}          旋转后的坐标\n */\nconst getRotatedPoint = (point, center, rotate) => {\n  /**\n   * 旋转公式：\n   *  点a(x, y)\n   *  旋转中心c(x, y)\n   *  旋转后点n(x, y)\n   *  旋转角度θ\n   * nx = cosθ * (ax - cx) - sinθ * (ay - cy) + cx\n   * ny = sinθ * (ax - cx) + cosθ * (ay - cy) + cy\n   */\n  return {\n    x: (point.x - center.x) * Math.cos(degreeToRadian(rotate)) - (point.y - center.y) * Math.sin(degreeToRadian(rotate)) + center.x,\n    y: (point.x - center.x) * Math.sin(degreeToRadian(rotate)) + (point.y - center.y) * Math.cos(degreeToRadian(rotate)) + center.y\n  }\n}\n\nconst absoluteZoom = (num, scaling) => (num / scaling * 100).toFixed(2)\n\nexport default {\n  getPositionInSvg,\n  degreeToRadian,\n  getRotatedPoint,\n  absoluteZoom\n}\n\n\n// WEBPACK FOOTER //\n// ./src/common.js","<template>\n  <rect\n    :x=\"x + correctX\"\n    :y=\"y + correctY\"\n    :width=\"width\"\n    :height=\"height\"\n    stroke=\"#000\"\n    stroke-width=\"1\"\n    fill=\"transparent\"\n    @mousedown=\"dragElement\"\n  />\n</template>\n\n<script>\nimport common from '../common'\n\nconst THROTTLE_DELAY_TIME = 30\n\nconst Utils = {\n  /**\n   * 函数节流 返回函数连续调用时，fn 执行频率限定为每多少时间执行一次\n   * @param fn         {function}  需要调用的函数\n   * @param delay      {number}    延迟时间，单位毫秒\n   * @param immediate  {bool}      给 immediate 参数传递 false，绑定的函数先执行，而不是delay后后执行\n   * @return           {function}  实际调用函数\n   */\n  throttle(fn, delay, immediate = false, debounce = false) {\n    let curr = +new Date()\n    let last_call = 0\n    let last_exec = 0\n    let timer = null\n    let diff\n    let context\n    let args\n    const exec = function() {\n      last_exec = curr\n      fn.apply(context, args)\n    }\n\n    return function() {\n      curr = +new Date()\n      context = this\n      args = arguments\n      diff = curr - (debounce ? last_call : last_exec) - delay\n\n      clearTimeout(timer)\n\n      if (debounce) {\n        if (immediate) {\n          timer = setTimeout(exec, delay)\n        } else if (diff >= 0) {\n          exec()\n        }\n      } else {\n        if (diff >= 0) {\n          exec()\n        } else if (immediate) {\n          timer = setTimeout(exec, -diff)\n        }\n      }\n\n      last_call = curr\n    }\n  }\n}\n\nconst pointsToSize = points => ({\n  x: points[0][0],\n  y: points[1][0],\n  width: points[0][2] - points[0][0],\n  height: points[1][2] - points[1][0],\n})\n\nconst getPoints = (rect, correctX = 0, correctY = 0) => {\n  const xMin = rect.x + correctX\n  const xMid = rect.x + rect.width / 2 + correctX\n  const xMax = rect.x + rect.width + correctX\n  const yMin = rect.y + correctY\n  const yMid = rect.y + rect.height / 2 + correctY\n  const yMax = rect.y + rect.height + correctY\n\n  return [\n    [xMin, xMid, xMax],\n    [yMin, yMid, yMax]\n  ]\n}\n\n/**\n * Points [\n *   [xMin, xMid, xMax],\n *   [yMin, yMid, yMax]\n * ]\n */\nexport default {\n  name: 'rectangle',\n  props: ['id', 'points', 'getViewportRef', 'correctX', 'correctY'],\n  data() {\n    return pointsToSize(this.points)\n  },\n  watch: {\n    points(val) {\n      Object.assign(this, pointsToSize(val))\n    }\n  },\n  methods: {\n    dragElement(e) {\n      let draged = false\n      const viewportRef = this.getViewportRef()\n      const mouseDownPosition = common.getPositionInSvg(viewportRef, e)\n      const originPosition = {\n        x: this.x,\n        y: this.y\n      }\n\n      const dragMoveHandler = e => {\n        draged = true\n        const currentPosition = common.getPositionInSvg(viewportRef, e)\n\n        Object.assign(this, {\n          x: originPosition.x + currentPosition.x - mouseDownPosition.x,\n          y: originPosition.y + currentPosition.y - mouseDownPosition.y,\n        })\n\n        this.$emit('draging', this.id, getPoints(this))\n      }\n\n      const mousemoveHandler = Utils.throttle(dragMoveHandler, THROTTLE_DELAY_TIME, true)\n\n      const mouseupHandler = ev => {\n        draged && this.$emit('update:points', getPoints(this, this.correctX, this.correctY))\n        window.removeEventListener('mousemove', mousemoveHandler)\n        window.removeEventListener('mouseup', mouseupHandler)\n      }\n\n      window.addEventListener('mousemove', mousemoveHandler)\n      window.addEventListener('mouseup', mouseupHandler)\n    }\n  }\n}\n</script>\n\n\n// WEBPACK FOOTER //\n// src/components/rectangle.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('rect',{attrs:{\"x\":_vm.x + _vm.correctX,\"y\":_vm.y + _vm.correctY,\"width\":_vm.width,\"height\":_vm.height,\"stroke\":\"#000\",\"stroke-width\":\"1\",\"fill\":\"transparent\"},on:{\"mousedown\":_vm.dragElement}})}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-655563ff\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/rectangle.vue\n// module id = null\n// module chunks = ","<template>\n  <svg viewBox=\"0 0 1000 1000\" width=\"800\" height=\"800\" ref=\"svg\">\n    <rect width=\"100%\" height=\"100%\" fill=\"none\" stroke=\"#000\" x=\"0\" y=\"0\" />\n    <rectangle\n      v-for=\"(props, i) in shapeList\"\n      :key=\"props.id\"\n      :id=\"props.id\"\n      :points.sync=\"props.points\"\n      :getViewportRef=\"getViewportRef\"\n      :correctX=\"dragingShape === props.id ? correctX : 0\"\n      :correctY=\"dragingShape === props.id ? correctY : 0\"\n      @draging=\"handleDragingShape\"\n      @update:points=\"handleDragEnd\"\n    />\n\n    <line\n      :x1=\"measuringLine[0][0][0]\"\n      :y1=\"measuringLine[0][0][1]\"\n      :x2=\"measuringLine[0][1][0]\"\n      :y2=\"measuringLine[0][1][1]\"\n      stroke=\"#f00\"\n      stroke-width=\"2\"\n    />\n\n    <line\n      :x1=\"measuringLine[1][0][0]\"\n      :y1=\"measuringLine[1][0][1]\"\n      :x2=\"measuringLine[1][1][0]\"\n      :y2=\"measuringLine[1][1][1]\"\n      stroke=\"#f00\"\n      stroke-width=\"2\"\n    />\n  </svg>\n</template>\n\n<script>\nimport common from '../common'\nimport rectangle from './rectangle'\n\n// 吸附阈值\nconst DISTANCE_THRESHOLD = 8\n\nconst RectList = [\n  {x: 124, y: 125, width: 100, height: 100},\n  {x: 723, y: 265, width: 200, height: 130},\n  {x: 482, y: 422, width: 130, height: 200},\n  {x: 208, y: 402, width: 231, height: 503}\n]\n\nconst getPoints = rect => {\n  const xMin = rect.x\n  const xMid = rect.x + rect.width / 2\n  const xMax = rect.x + rect.width\n  const yMin = rect.y\n  const yMid = rect.y + rect.height / 2\n  const yMax = rect.y + rect.height\n\n  return [\n    [xMin, xMid, xMax],\n    [yMin, yMid, yMax]\n  ]\n}\n\nexport default {\n  components: {\n    rectangle\n  },\n  data() {\n    const ID_TEMPLATE = +new Date()\n\n    const shapeList = RectList.map((rect, i) => {\n      return {\n        id: ID_TEMPLATE + i,\n        points: getPoints(rect),\n        ...rect\n      }\n    })\n\n    return {\n      shapeList,          // 图形集合\n      measuringLine: [    // 吸附参考线\n        [[0, 0], [0, 0]],\n        [[0, 0], [0, 0]]\n      ],\n      dragingShape: null, // 拖拽中的图形\n      correctX: 0,        // 拖拽中的图形的x轴修正值\n      correctY: 0         // 拖拽中的图形的y轴修正值\n    }\n  },\n  methods: {\n    getViewportRef() {\n      return this.$refs.svg\n    },\n\n    handleDragingShape(shapeId, dragingShapePoints) {\n      const measuringLineX = [[0, 0], [0, 0]]\n      const measuringLineY = [[0, 0], [0, 0]]\n\n      // 拖拽中的元素与参考元素的x轴关系值\n      let closestX = {\n        points: null,       // 参考对象的关键点集合\n        distance: Infinity, // 与参考对象的x轴关键点的差值绝对值的最小值\n        pointIndex: 0,      // 参考的关键点索引 0: xMin, 1: xMid, 2: xMax\n        correct: 0          // x轴修正值\n      }\n\n      let closestY = {\n        points: null,\n        distance: Infinity,\n        pointIndex: 0, \n        correct: 0\n      }\n\n      this.shapeList.forEach(shape => {\n        if (shape.id === shapeId) {\n          return\n        }\n\n        const pointXDiff = [\n          [shape.points[0][0] - dragingShapePoints[0][0], 0],\n          [shape.points[0][0] - dragingShapePoints[0][1], 0],\n          [shape.points[0][0] - dragingShapePoints[0][2], 0],\n          [shape.points[0][1] - dragingShapePoints[0][0], 1],\n          [shape.points[0][1] - dragingShapePoints[0][1], 1],\n          [shape.points[0][1] - dragingShapePoints[0][2], 1],\n          [shape.points[0][2] - dragingShapePoints[0][0], 2],\n          [shape.points[0][2] - dragingShapePoints[0][1], 2],\n          [shape.points[0][2] - dragingShapePoints[0][2], 2]\n        ]\n\n        const pointYDiff = [\n          [shape.points[1][0] - dragingShapePoints[1][0], 0],\n          [shape.points[1][0] - dragingShapePoints[1][1], 0],\n          [shape.points[1][0] - dragingShapePoints[1][2], 0],\n          [shape.points[1][1] - dragingShapePoints[1][0], 1],\n          [shape.points[1][1] - dragingShapePoints[1][1], 1],\n          [shape.points[1][1] - dragingShapePoints[1][2], 1],\n          [shape.points[1][2] - dragingShapePoints[1][0], 2],\n          [shape.points[1][2] - dragingShapePoints[1][1], 2],\n          [shape.points[1][2] - dragingShapePoints[1][2], 2]\n        ]\n\n        pointXDiff.forEach(diff => {\n          const distance = Math.abs(diff[0])\n          if (distance < closestX.distance && (distance < DISTANCE_THRESHOLD)) {\n            closestX = {\n              distance,\n              pointIndex: diff[1],\n              points: shape.points,\n              correct: diff[0]\n            }\n          }\n        })\n\n        pointYDiff.forEach(diff => {\n          const distance = Math.abs(diff[0])\n          if (distance < closestY.distance && (distance < DISTANCE_THRESHOLD)) {\n            closestY = {\n              distance,\n              pointIndex: diff[1],\n              points: shape.points,\n              correct: diff[0]\n            }\n          }\n        })\n      })\n\n      if (closestX.points !== null) {\n        if (closestX.pointIndex == 0) {\n          measuringLineX[0][0] = closestX.points[0][0]\n          measuringLineX[1][0] = closestX.points[0][0]\n        } else if (closestX.pointIndex === 1) {\n          measuringLineX[0][0] = closestX.points[0][1]\n          measuringLineX[1][0] = closestX.points[0][1]\n        } else { // closestX.pointIndex === 2\n          measuringLineX[0][0] = closestX.points[0][2]\n          measuringLineX[1][0] = closestX.points[0][2]\n        }\n\n        if (closestX.points[1][0] > dragingShapePoints[1][0]) {\n          measuringLineX[0][1] = dragingShapePoints[1][0] + closestY.correct\n          measuringLineX[1][1] = closestX.points[1][2]\n        } else {\n          measuringLineX[0][1] = closestX.points[1][0]\n          measuringLineX[1][1] = dragingShapePoints[1][2] + closestY.correct\n        }\n      }\n\n      if (closestY.points !== null) {\n        if (closestY.pointIndex == 0) {\n          measuringLineY[0][1] = closestY.points[1][0]\n          measuringLineY[1][1] = closestY.points[1][0]\n        } else if (closestY.pointIndex === 1) {\n          measuringLineY[0][1] = closestY.points[1][1]\n          measuringLineY[1][1] = closestY.points[1][1]\n        } else { // closestY.pointIndex === 2\n          measuringLineY[0][1] = closestY.points[1][2]\n          measuringLineY[1][1] = closestY.points[1][2]\n        }\n\n        if (closestY.points[0][0] > dragingShapePoints[0][0]) {\n          measuringLineY[0][0] = dragingShapePoints[0][0] + closestX.correct\n          measuringLineY[1][0] = closestY.points[0][2]\n        } else {\n          measuringLineY[0][0] = closestY.points[0][0]\n          measuringLineY[1][0] = dragingShapePoints[0][2] + closestX.correct\n        }\n      }\n\n      this.measuringLine = [\n        measuringLineX,\n        measuringLineY\n      ]\n\n      this.dragingShape = shapeId\n      this.correctX = closestX.correct\n      this.correctY = closestY.correct\n    },\n\n    handleDragEnd() {\n      this.dragingShape = null\n      this.correctX = 0\n      this.correctY = 0\n\n      this.measuringLine = [\n        [[0, 0], [0, 0]],\n        [[0, 0], [0, 0]]\n      ]\n    }\n  }\n}\n</script>\n\n\n// WEBPACK FOOTER //\n// src/components/svg-canvas.vue","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./rectangle.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./rectangle.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-655563ff\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./rectangle.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/rectangle.vue\n// module id = null\n// module chunks = ","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg',{ref:\"svg\",attrs:{\"viewBox\":\"0 0 1000 1000\",\"width\":\"800\",\"height\":\"800\"}},[_c('rect',{attrs:{\"width\":\"100%\",\"height\":\"100%\",\"fill\":\"none\",\"stroke\":\"#000\",\"x\":\"0\",\"y\":\"0\"}}),_vm._v(\" \"),_vm._l((_vm.shapeList),function(props,i){return _c('rectangle',{key:props.id,attrs:{\"id\":props.id,\"points\":props.points,\"getViewportRef\":_vm.getViewportRef,\"correctX\":_vm.dragingShape === props.id ? _vm.correctX : 0,\"correctY\":_vm.dragingShape === props.id ? _vm.correctY : 0},on:{\"update:points\":[function($event){_vm.$set(props, \"points\", $event)},_vm.handleDragEnd],\"draging\":_vm.handleDragingShape}})}),_vm._v(\" \"),_c('line',{attrs:{\"x1\":_vm.measuringLine[0][0][0],\"y1\":_vm.measuringLine[0][0][1],\"x2\":_vm.measuringLine[0][1][0],\"y2\":_vm.measuringLine[0][1][1],\"stroke\":\"#f00\",\"stroke-width\":\"2\"}}),_vm._v(\" \"),_c('line',{attrs:{\"x1\":_vm.measuringLine[1][0][0],\"y1\":_vm.measuringLine[1][0][1],\"x2\":_vm.measuringLine[1][1][0],\"y2\":_vm.measuringLine[1][1][1],\"stroke\":\"#f00\",\"stroke-width\":\"2\"}})],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-786ee9dc\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/svg-canvas.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./svg-canvas.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./svg-canvas.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-786ee9dc\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./svg-canvas.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/svg-canvas.vue\n// module id = null\n// module chunks = ","import SvgCanvas from './components/svg-canvas'\n\nexport default {\n  render(h) {\n    return <SvgCanvas />\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","import Vue from 'vue'\nimport App from './app'\n\nVue.config.productionTip = false\n\nnew Vue({\n  el: '#app',\n  render: h => h(App)\n})\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}